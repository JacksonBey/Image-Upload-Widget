
        thumbnail.style.border = '2px solid red'; // Red border for unsaved
        thumbnail.addEventListener('click', function () {
          const img = new Image();
          img.src = this.src;
          img.onload = function () {
            start(img);
          };
        });
        unsavedArea.appendChild(thumbnail);
      });
    }

    window.addEventListener('DOMContentLoaded', function () {
      const imageInput = document.getElementById('image');

      imageInput.addEventListener('change', function (event) {
        const file = event.target.files[0];

        if (file && file.type.startsWith('image/')) {
          const reader = new FileReader();
          reader.onload = function (e) {
            const img = new Image();
            img.src = e.target.result;
            img.onload = function () {
              start(img);
            };
          };
          reader.readAsDataURL(file);
        } else {
          console.log('No image file selected or wrong file type.');
        }
      });

      // Save button logic
      const saveBtn = document.getElementById('save');
      saveBtn.removeEventListener('click', saveImage);  // Remove previous event listeners to avoid multiple saves
      saveBtn.addEventListener('click', saveImage);

      function saveImage() {
        const canvas = document.getElementById('canvas');
        const thumbnail = document.createElement('img');
        thumbnail.src = canvas.toDataURL();
        thumbnail.width = 100;
        thumbnail.addEventListener('click', function () {
          thumbnailToReplace = this;
          const img = new Image();
          img.src = this.src;
          img.onload = function () {
            start(img);
          };
        });
        document.getElementById('thumbnails').appendChild(thumbnail);
        // Remove from unsaved if exists
        const index = unsavedThumbnails.indexOf(canvas.toDataURL());
        if (index > -1) {
          unsavedThumbnails.splice(index, 1);
          renderUnsavedThumbnails();
        }
      }
    });
  </script>
</body>

</html>
